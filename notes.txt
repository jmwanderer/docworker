General Notes

Production Notes:

Build and Install docworker package:

git pull
python3 -m build  --wheel
result: dist/docworker-0.1.0-py3-none-any.whl
pip uninstall docworker
pip install docworker-0.1.0-py3-none-any.whl

Initial Configuration:
cp config.py ~/.local/var/docworker.analysis_app-instance/

config.py:
OPENAI_API_KEY = 'xx'
SECRET_KEY = 'xx'
PROXY_CONFIG=True
# Needed only to send registration emails
SMTP_SERVER='xx'
SMTP_USER='xx'
SMTP_PASSWORD='xx'
SMPT_FROM='xx'

Using venv:
mkdir project
cd project
python3 -m venv venv
. ./venv/bin/activate

cp config.py venv/var/docworker.analysis_app-instance/


Run a production server:
python3 -m waitress --url-prefix docworker  --port 8082 --call docworker.analysis_app:create_app


Configure Apache as a proxy server:

/etc/apache2/sites-enabled/000-default-le-ssl.conf 
    ProxyPass /docworker http://127.0.0.1:8082
    ProxyPassReverse /docworker http://127.0.0.1:8082

use --url-prefix instead of:
    #RequestHeader set X-Forwarded-Prefix /docworker
sudo service apache2 restart



Configure as a system service

cp docworker.service /lib/systemd/system
sudo systemctl enable docworker

sudo service docworker status
sudo service docworker restart


Command line:

python3 -m docworker.add_user
python3 -m unittest docworker/docx_util_test.py
python3 -m docworker.docx_summary


Run in debug mode
flask --app "analysis_app:create_app(debug=True)" run --debug
or
flask --app "analysis_app:create_app(debug=True,fakeai=True)" run --debug


Update sample docs:
rm docworker/samples/*.daf

python3 -m docworker.dw_cli docworker/samples --import_doc 'docworker/samples/PA utility.docx'
python3 -m docworker.dw_cli docworker/samples --import_doc 'docworker/samples/PA Agenda.docx'
python3 -m docworker.dw_cli docworker/samples --import_doc docworker/samples/creative-llc.docx
python3 -m docworker.dw_cli docworker/samples --import_doc docworker/samples/creative-llc.pdf
python3 -m docworker.dw_cli docworker/samples --import_doc docworker/samples/groff-dejoy.pdf


python3 -m docworker.docx_summary --new docworker/samples/PA\ Agenda.docx docworker/samples/PA_Agenda.docx.daf
python3 -m docworker.docx_summary --new docworker/samples/'DRAFT SCAP Key Actions and Work Plan (February 2023).docx' docworker/samples/DRAFT_SCAP_Key_Actions_and_Work_Plan_February_2023.docx.daf
python3 -m docworker.docx_summary --new docworker/samples/creative-llc-v-elenis.docx docworker/samples/creative-llc-v-elenis.docx.daf

# Load and debug a session in Python: 
from docworker import docx_util
s = docx_util.load_session("instance/username/DRAFT_SCAP_Key_Actions_and_Work_Plan_February_2023.docx.daf")




